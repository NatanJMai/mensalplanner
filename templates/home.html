<!-- variables from Python: 
    account, 
    tasks, 
    days_month, 
    week_days, 
    day_and_tasks 
-->

{% extends 'layout.html' %}

{% block title %}Home{% endblock %}

{% block content %}
<h2>Welcome back, {{ account['username'] }}. Here your today tasks:</h2>

<div>
    <div class="wrapper">
        <!-- Week Days: 'Monday', 'Tuesday' etc. -->
        {% for d in range(0,7) %}
            <div class="wrapper-weekday">
                <h1> {{ week_days[d] }} </h1>
            </div>
        {% endfor %}

        <!-- Every day of month -->
        {% for week in days_month %}
            {% for day in week %}
                {% if day != 0 %}

                    <article class="box">
                        <h1> DIA {{day}} </h1>
                        {% if day in day_and_tasks %}
                            
                            <!-- Display tasks of day -->
                            {% for dtask in day_and_tasks[day] %}
                                <button id="{{ dtask[0] }}" type="button" class="button-5 common">
                                    {{ dtask[1] }} <br /> {{ dtask[7] }}
                                </button>
                            {% endfor %}
                        {% endif %}
                    </article>

                {% else %}
                    <div class="wrapper-day"></div>
                {% endif %}
            {% endfor %}
        {% endfor %}
    </div>
    
    <div id = "div_task" class="centered centeredbox" style="visibility:hidden"></div>
</div>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script>
    $('.common').click(clickTask)

    function clickTask() {
        //alert("click from " + $(this.id))

        var task_id = this.id;

        $.ajax({
            url: "/mensalplanner/view_task",
            type: "get",
            data: { jsdata: task_id },
            success: function (response) {
                $("#div_task").html(response);
                $('div#div_task').css('visibility', 'visible')
            },
            error: function (xhr) {
                //Do Something to handle error
            }
        });
    }
</script>

<script type="application/javascript">
    /* function hidden_show(name) {
         var element = document.getElementById("third");
         var hidden  = element.getAttribute("hidden");

         if (hidden) {
             element.removeAttribute("hidden");
         } else {
             element.setAttribute("hidden", "hidden");
         }
     } */

     function hidden_show_update(button, div_first, div_second) {
         var button    = document.getElementById(button);

         var element_first  = document.getElementById(div_first);
         var element_second = document.getElementById(div_second);
         
         // var element_details = document.getElementById("div_details");
         // var element_update  = document.getElementById("div_update");

         var hidden_first  = element_first.getAttribute("hidden");
         var hidden_second = element_second.getAttribute("hidden");

         console.log(hidden_first);

         if (hidden_first) {
             element_first.removeAttribute("hidden");
         } else {
             element_first.setAttribute("hidden", "hidden");
         }

         if (hidden_second) {
             element_second.removeAttribute("hidden");
             button.setAttribute("hidden", "hidden");
         } else {
             element_second.setAttribute("hidden", "hidden");
         }
     }
</script>


{% endblock %}